# 概述

## 调整原因

为什么调整协议？

- 所有的数据混合在一个帧里，使用起来容易混淆
- 64字节不够了，在加入zengValue、closeValue、发动机转速、燃油温度后64字节不足以存储原来的数据
- 原协议中的有些数据没有使用到

## 调整方式

移除不使用的量，如工程控制、手动啥之类的。

### 单片机到作动器服务

```c
#include <stdint.h>
// 反应设备状态
// Toolchain Hints: 小端、自然对齐
// 成员命名来自web app
// 总是位于Frame的Data区域, 从Data区域的地址0开始
struct ReadonlyStatus {
    uint16_t leftPress; // 左油杆压力
    uint16_t systemPress; // 系统压力
    uint16_t controlPress; // 控制压力
    uint16_t waterTank; // 水箱液位
    uint16_t hydraulic; // 液压油液位
    uint16_t closeValue; // 闸门开度
    uint16_t speed;
    uint16_t waterWe; // 冷却水温度
    uint16_t fuelWe; // 燃油温度
    uint16_t hydraulicWe; // 液压油温度
    uint16_t leftPointSpeed; // 左吊点速度
    uint16_t rightPointSpeed; // 右吊点速度
    uint16_t motorSpeed; // 发动机转速
    uint16_t battery; // 启动电池电量
};
struct ReadWriteStatus {
    uint8_t windRun;
    uint8_t motorRun;
    uint8_t gearValue; // 发动机档位, 百分比0-100
    uint8_t zengValue; // 0,1,2,3
    uint8_t zengPreset[3]; // 预设的增容量
    uint16_t closeValue; // 0-300 cm
};
struct DeviceStatus {
    struct ReadonlyStatus Ro; // 28 bytes
    struct ReadWriteStatus Rw; // 10 bytes, 其中1个是因为自然对齐补上的空白
}; // Total : 38 bytes
```


